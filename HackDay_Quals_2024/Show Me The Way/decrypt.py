from sage.all import *
from Crypto.Util.number import *

C = 2565617200166195847141820928636232303959466722932792435323711473965652085371699818644409256990409854048944273889028395427212647285096620147927751484918108065303000987005428811601509106033544824154004155247749651849388960745201851220865639078232468837572017487899553302561947972350180790337323260039010564873086627329116972503791322926648544263487729211803983796460777700080964480684225095759331029591580667172315329031801221006095830894913366492646106198809678335180404967834014465213071012334463161243798668249316387388896615356529679219334762683987621996735445923292411584267482736997931521981371010250736803883850124086811981296847046184646544341090182005804326034206846831836495437948287344937128613750220151417179776923247572197141730803872869207722489892434431306177467240055054918472090059029917750015977990019074665525769825707485580566711901744843592821082242610459526779285285457758540532197630815918118376169006356119855487579630979321639934789282013802634090104249954889447300640494797136454210084024870216383477122432977329939795881446508639802099815243215786621936463817640047721308586018053015489260037207134192787282389359286090040755235606024014221310785716415247412510214122721056658870318538556573512692
N = 10274622173320909389031395002382723520310683266624262003758324433654540040809219233599998390391541291081480955769558063877739745263628876566148594399190487217520529947703418385797126076202883896285563297412493796455549735516349258737267111485734958124647676862139978578822328063131028977645973314255958832814431129401741363681924246624731580306332996274947224225276913011825249480579351788647303424376829926794897238480915821396590836505557261932201793218787876369479689474390699568395442160695951675495911526788768792712587827140759752600815834201530200102574327547287838813124748635529299343877238787638666002517369183147324348276580386835912162978347500880951405211071469315569907393288673767750500338439908319636060342999154216171420367334387728243762904978917643239586128408102087398429687219613116999755320251996795637299545734755393100528238070409625880097215206538255250563512463977488434914174814989014820102387306536769608806232340706951978003787459755560489338182409731880347246492232556511479625859446872995332197943657987872417697758505073815646447821621770469326686335161275436219144215858159910848423968589115317782429522873529296494028537507162631866445206682695650087594304263021619605307406513658218147729
e = 0x10001

x = PolynomialRing(RationalField(), 'x').gen()
poly = 0

N_temp = N
count = 0
while N_temp:
    digit = N_temp%7
    if digit:
        poly = poly + digit*x**count
    count+=1
    N_temp//=7

print(poly)
(P,_),(Q,_)=poly.factor()
print(P,Q,sep='\n')

p = P(7)
q = Q(7)
phi = (p-1)*(q-1)

def binpow(a,b,mod):
    ans = 1
    while b:
        if b&1:
            ans = (ans*a)%mod
        b//=2
        a*=a
    return ans

d = pow(int(e),int(-1),int(phi))
m = pow(C,d,N)
print(long_to_bytes(m)[::-1])
